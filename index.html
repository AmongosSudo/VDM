<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VDM Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #FFE500;
            --primary-color-hover: #e6cf00;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
        }
        
        /* --- Sidebar Styles --- */
        .sidebar {
            width: 5rem; /* Collapsed width */
            transition: width 0.3s ease-in-out;
        }
        .sidebar:hover {
            width: 16rem; /* Expanded width */
        }
        .sidebar .sidebar-logo {
            transition: all 0.3s ease-in-out;
        }
        .sidebar:hover .sidebar-logo {
            transform: scale(1.05);
        }
        .sidebar-item-label {
            opacity: 0;
            width: 0;
            transition: opacity 0.2s ease-in-out, width 0.1s ease-in-out;
            white-space: nowrap;
            overflow: hidden;
        }
        .sidebar:hover .sidebar-item-label {
            opacity: 1;
            width: auto;
            margin-left: 0.75rem;
        }
        .sidebar-item {
            color: #4a5568; /* gray-700 */
            transition: all 0.2s ease-in-out;
            justify-content: center;
        }
        .sidebar:hover .sidebar-item {
            justify-content: flex-start;
        }
        .sidebar-item.active, .sidebar-item:hover {
            background-color: var(--primary-color);
            color: #1a202c; /* gray-900 */
        }
        .sidebar-item.active svg, .sidebar-item:hover svg {
            color: #1a202c;
        }
        main {
            margin-left: 5rem; /* Match collapsed sidebar width */
            transition: margin-left 0.3s ease-in-out;
        }
        .sidebar:hover ~ main {
            margin-left: 16rem; /* Match expanded sidebar width */
        }

        /* --- Form & Card Styles --- */
        .form-container {
            transition: all 0.5s ease-in-out;
            max-height: 0;
            overflow: hidden;
            opacity: 0;
        }
        .form-container.show {
            max-height: 2500px; /* Adjust as needed */
            opacity: 1;
        }
        .model-card {
            animation: fadeIn 0.5s ease-in-out;
            position: relative;
        }
        .model-card-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            cursor: pointer;
        }
        .model-card:hover .model-card-overlay {
            opacity: 1;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Modal Styles --- */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal-overlay.show .modal-content {
            transform: scale(1);
        }

        /* --- Chatbot Styles --- */
        .chat-bubble-user { background-color: var(--primary-color); color: #1a202c; }
        .chat-bubble-bot { background-color: #e2e8f0; }
        .typing-indicator span { height: 8px; width: 8px; float: left; margin: 0 1px; background-color: #9E9EA1; display: block; border-radius: 50%; opacity: 0.4; animation: 1s blink infinite .3333s; }
        .typing-indicator span:nth-child(2) { animation-delay: .6666s; }
        .typing-indicator span:nth-child(3) { animation-delay: .9999s; }
        @keyframes blink { 50% { opacity: 1; } }

        /* --- General Button Styles --- */
        .main-btn { background-color: var(--primary-color); color: #1a202c; font-weight: bold; padding: 0.75rem 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -2px rgba(0,0,0,0.1); transition: all 0.2s ease-in-out; }
        .main-btn:hover { background-color: var(--primary-color-hover); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="sidebar bg-white text-gray-800 flex flex-col fixed h-full border-r border-gray-200 z-10">
            <div class="h-20 flex items-center justify-center px-4 border-b border-gray-200">
                 <!-- Logo -->
                <img src="https://i.ibb.co/9g3v2Y9/image-9bbe9d.png" alt="VDM Logo" class="h-12 sidebar-logo">
            </div>
            <!-- Navigation moved to a flex container to center it -->
            <div class="flex-1 flex flex-col justify-center">
                <nav class="flex-1 px-2 py-6 space-y-2">
                    <a href="#" class="sidebar-item flex items-center px-4 py-3 rounded-lg" data-tab="dashboard">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layout-dashboard flex-shrink-0"><rect width="7" height="9" x="3" y="3" rx="1"/><rect width="7" height="5" x="14" y="3" rx="1"/><rect width="7" height="9" x="14" y="12" rx="1"/><rect width="7" height="5" x="3" y="16" rx="1"/></svg>
                        <span class="sidebar-item-label">Dashboard</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center px-4 py-3 rounded-lg" data-tab="add-models">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user-plus flex-shrink-0"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" x2="19" y1="8" y2="14"/><line x1="22" x2="16" y1="11" y2="11"/></svg>
                        <span class="sidebar-item-label">Manage Models</span>
                    </a>
                    <a href="#" class="sidebar-item flex items-center px-4 py-3 rounded-lg" data-tab="lubna">
                         <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot flex-shrink-0"><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></svg>
                        <span class="sidebar-item-label">Lubna Assistant</span>
                    </a>
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 p-6 lg:p-10">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content">
                <h2 class="text-3xl font-bold mb-8">Dashboard</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Info Cards -->
                    <div class="bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-xl"><div class="flex items-center"><div class="p-3 bg-green-100 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dollar-sign text-green-600"><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div><div class="ml-4"><p class="text-gray-500">Revenue</p><p class="text-2xl font-bold">$45,231.89</p></div></div></div>
                    <div class="bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-xl"><div class="flex items-center"><div class="p-3 bg-blue-100 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trending-up text-blue-600"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg></div><div class="ml-4"><p class="text-gray-500">Profit</p><p class="text-2xl font-bold">$12,801.45</p></div></div></div>
                    <div class="bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-xl"><div class="flex items-center"><div class="p-3 bg-yellow-100 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-users text-yellow-600"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg></div><div class="ml-4"><p class="text-gray-500">Total Models</p><p class="text-2xl font-bold">73</p></div></div></div>
                    <div class="bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-xl"><div class="flex items-center"><div class="p-3 bg-red-100 rounded-lg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-eye text-red-600"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg></div><div class="ml-4"><p class="text-gray-500">Daily Visitors</p><p class="text-2xl font-bold">1,209</p></div></div></div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md transition-shadow hover:shadow-xl">
                    <h3 class="text-xl font-semibold mb-4 text-gray-700">Revenue Overview</h3>
                    <div class="h-80"><canvas id="revenueChart"></canvas></div>
                </div>
            </div>

            <!-- Add Models Tab -->
            <div id="add-models" class="tab-content hidden">
                <h2 class="text-3xl font-bold mb-8">Manage Models</h2>
                
                <!-- Toolbar: Search and Add Button -->
                <div class="flex flex-wrap gap-4 items-center justify-between mb-6">
                    <div class="relative flex-grow max-w-sm">
                        <input type="text" id="search-model-input" placeholder="Search by name..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </div>
                    <button id="show-form-btn" class="main-btn flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-circle mr-2"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="16"/><line x1="8" x2="16" y1="12" y2="12"/></svg>
                        Add New Model
                    </button>
                </div>

                <!-- Add/Edit Model Form -->
                <div id="add-model-form-container" class="form-container bg-white p-8 rounded-xl shadow-lg mb-8">
                    <form id="add-model-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <h3 id="form-title" class="col-span-1 md:col-span-2 text-2xl font-semibold border-b pb-4 mb-2">New Model Information</h3>
                        <input type="hidden" id="editModelId">
                        
                        <!-- Form fields... -->
                        <div class="col-span-1"><label for="fullName" class="block text-sm font-medium text-gray-700 mb-1">Full Name</label><input type="text" id="fullName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label><input type="tel" id="phoneNumber" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Address</label><input type="email" id="email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="nationality" class="block text-sm font-medium text-gray-700 mb-1">Nationality</label><input type="text" id="nationality" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="languages" class="block text-sm font-medium text-gray-700 mb-1">Languages Spoken</label><input type="text" id="languages" placeholder="e.g., English, Arabic" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="location" class="block text-sm font-medium text-gray-700 mb-1">Location (City/Emirate)</label><input type="text" id="location" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="height" class="block text-sm font-medium text-gray-700 mb-1">Height (cm)</label><input type="number" id="height" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="experience" class="block text-sm font-medium text-gray-700 mb-1">Experience Level</label><select id="experience" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"><option>Beginner</option><option>Intermediate</option><option>Pro</option></select></div>
                        <div class="col-span-1 md:col-span-2"><label for="clients" class="block text-sm font-medium text-gray-700 mb-1">Previous Clients / Campaigns</label><textarea id="clients" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></textarea></div>
                        <div class="col-span-1 md:col-span-2"><label for="portfolio" class="block text-sm font-medium text-gray-700 mb-1">Instagram or Portfolio Link</label><input type="url" id="portfolio" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="profilePhoto" class="block text-sm font-medium text-gray-700 mb-1">Profile Photo</label><input type="file" id="profilePhoto" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-yellow-100 file:text-yellow-700 hover:file:bg-yellow-200 transition"></div>
                        <div class="col-span-1"><label for="gallery" class="block text-sm font-medium text-gray-700 mb-1">Gallery (Photos)</label><input type="file" id="gallery" multiple accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-yellow-100 file:text-yellow-700 hover:file:bg-yellow-200 transition"></div>
                        <div class="col-span-1"><label for="videos" class="block text-sm font-medium text-gray-700 mb-1">Videos</label><input type="file" id="videos" multiple accept="video/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-yellow-100 file:text-yellow-700 hover:file:bg-yellow-200 transition"></div>
                        <div class="col-span-1 md:col-span-2"><label class="block text-sm font-medium text-gray-700 mb-2">Willing to Wear</label><div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-4" id="willingToWearCheckboxes"><label class="flex items-center space-x-2"><input type="checkbox" value="Traditional" class="rounded text-yellow-500 focus:ring-yellow-400"><span>Traditional</span></label><label class="flex items-center space-x-2"><input type="checkbox" value="Casual" class="rounded text-yellow-500 focus:ring-yellow-400"><span>Casual</span></label><label class="flex items-center space-x-2"><input type="checkbox" value="Glamour" class="rounded text-yellow-500 focus:ring-yellow-400"><span>Glamour</span></label><label class="flex items-center space-x-2"><input type="checkbox" value="Swimwear" class="rounded text-yellow-500 focus:ring-yellow-400"><span>Swimwear</span></label><label class="flex items-center space-x-2"><input type="checkbox" value="Lingerie" class="rounded text-yellow-500 focus:ring-yellow-400"><span>Lingerie</span></label></div></div>
                        <h3 class="col-span-1 md:col-span-2 text-xl font-semibold border-b pb-3 mb-1 mt-4">Internal & Financial</h3>
                        <div class="col-span-1"><label for="rate" class="block text-sm font-medium text-gray-700 mb-1">Rate per Project/Day ($)</label><input type="number" id="rate" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1"><label for="commission" class="block text-sm font-medium text-gray-700 mb-1">Commission Split (%)</label><input type="number" id="commission" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1 md:col-span-2"><label for="iban" class="block text-sm font-medium text-gray-700 mb-1">IBAN Number</label><input type="text" id="iban" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></div>
                        <div class="col-span-1 md:col-span-2"><label for="notes" class="block text-sm font-medium text-gray-700 mb-1">Notes / Comments (Internal)</label><textarea id="notes" rows="3" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition"></textarea></div>
                        <div class="col-span-1 md:col-span-2 flex justify-end space-x-4 mt-4">
                            <button type="button" id="cancel-form-btn" class="bg-gray-200 text-gray-700 hover:bg-gray-300 font-bold py-2 px-6 rounded-lg transition">Cancel</button>
                            <button type="submit" id="save-model-btn" class="main-btn">Save Model</button>
                        </div>
                    </form>
                </div>

                <!-- Model Cards Container -->
                <div id="model-cards-container" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <!-- Example Card -->
                    <div class="bg-white rounded-xl shadow-md overflow-hidden model-card" data-model-id="model-1" data-model-info='{"id":"model-1","fullName":"Eleonora","phoneNumber":"+971 50 123 4567","email":"eleonora@example.com","nationality":"Italian","languages":"Italian, English","location":"Dubai","height":"175","experience":"Intermediate","clients":"Vogue Arabia, Chanel","portfolio":"https://instagram.com/eleonora","profilePhotoUrl":"https://images.unsplash.com/photo-1580489944761-15a19d654956?q=80&w=2561&auto=format&fit=crop","willingToWear":["Traditional","Casual","Glamour"],"rate":"1500","commission":"20","iban":"AE070331234567890123456","notes":"Very professional and punctual."}'>
                        <div class="relative">
                            <img class="h-64 w-full object-cover" src="https://images.unsplash.com/photo-1580489944761-15a19d654956?q=80&w=2561&auto=format&fit=crop" alt="Model Eleonora">
                            <div class="model-card-overlay">
                                <button class="edit-btn bg-blue-500 hover:bg-blue-600 p-3 rounded-full transition"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg></button>
                                <button class="delete-btn bg-red-500 hover:bg-red-600 p-3 rounded-full transition"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button>
                            </div>
                        </div>
                        <div class="p-4 cursor-pointer view-details-btn">
                            <h4 class="text-lg font-bold pointer-events-none">Eleonora</h4>
                            <p class="text-sm text-gray-500 pointer-events-none">Intermediate</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Lubna Tab -->
            <div id="lubna" class="tab-content hidden">
                 <h2 class="text-3xl font-bold mb-4">Lubna Assistant</h2>
                 <p class="text-gray-600 mb-8">Your personal AI assistant to help manage the agency.</p>
                 <div class="bg-white rounded-xl shadow-lg h-[calc(100vh-12rem)] flex flex-col">
                     <div id="chat-window" class="flex-1 p-6 overflow-y-auto">
                         <div class="flex items-start gap-3 mb-4"><div class="p-2 bg-gray-200 text-gray-800 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot"><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></svg></div><div class="chat-bubble-bot p-3 rounded-lg max-w-lg"><p>Hello! I'm Lubna. How can I assist you today? You can ask me to find a model, summarize revenue, or draft an email.</p></div></div>
                     </div>
                     <div id="typing-indicator" class="px-6 pb-2 hidden"><div class="flex items-start gap-3"><div class="p-2 bg-gray-200 text-gray-800 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot"><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></svg></div><div class="chat-bubble-bot p-3 rounded-lg"><div class="typing-indicator"><span></span><span></span><span></span></div></div></div></div>
                     <div class="p-4 border-t border-gray-200">
                         <form id="chat-form" class="flex items-center gap-4">
                             <input type="text" id="chat-input" placeholder="Ask Lubna anything..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent transition" autocomplete="off">
                             <button type="submit" class="main-btn p-3"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-send-horizontal"><path d="m3 3 3 9-3 9 19-9Z"/><path d="M6 12h16"/></svg></button>
                         </form>
                     </div>
                 </div>
            </div>
        </main>
    </div>

    <!-- Model Details Modal -->
    <div id="model-details-modal" class="modal-overlay">
        <div id="modal-content-box" class="modal-content">
            <!-- Content will be injected by JavaScript -->
        </div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Global State & Element References ---
        const sidebarItems = document.querySelectorAll('.sidebar-item');
        const tabContents = document.querySelectorAll('.tab-content');
        const showFormBtn = document.getElementById('show-form-btn');
        const cancelFormBtn = document.getElementById('cancel-form-btn');
        const formContainer = document.getElementById('add-model-form-container');
        const addModelForm = document.getElementById('add-model-form');
        const modelCardsContainer = document.getElementById('model-cards-container');
        const searchInput = document.getElementById('search-model-input');
        const modal = document.getElementById('model-details-modal');
        const modalContentBox = document.getElementById('modal-content-box');

        // --- Tab Navigation ---
        function switchTab(tabName) {
            tabContents.forEach(content => content.classList.toggle('hidden', content.id !== tabName));
            sidebarItems.forEach(item => item.classList.toggle('active', item.dataset.tab === tabName));
        }
        sidebarItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                switchTab(e.currentTarget.dataset.tab);
            });
        });
        switchTab('dashboard'); // Set initial tab

        // --- Dashboard Chart ---
        const ctx = document.getElementById('revenueChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Revenue',
                    data: [12000, 19000, 15000, 25000, 22000, 30000, 28000, 32000, 29000, 35000, 40000, 45231],
                    borderColor: 'rgba(255, 229, 0, 1)',
                    backgroundColor: 'rgba(255, 229, 0, 0.2)',
                    borderWidth: 3, tension: 0.4, fill: true,
                    pointBackgroundColor: 'rgba(255, 229, 0, 1)', pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff', pointHoverBorderColor: 'rgba(255, 229, 0, 1)',
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                scales: { y: { beginAtZero: true, grid: { color: '#e5e7eb' } }, x: { grid: { display: false } } },
                plugins: { legend: { display: false } }
            }
        });

        // --- Model Management ---

        // Function to show/hide the form
        const showForm = (show = true) => {
            formContainer.classList.toggle('show', show);
            if (!show) {
                addModelForm.reset();
                document.getElementById('editModelId').value = '';
                document.getElementById('form-title').textContent = 'New Model Information';
                document.getElementById('save-model-btn').textContent = 'Save Model';
                // Ensure required is present for new entries, but not for updates where photo might not change
                document.getElementById('profilePhoto').required = true;
            }
        };

        showFormBtn.addEventListener('click', () => showForm(true));
        cancelFormBtn.addEventListener('click', () => showForm(false));

        // Handle Form Submission (for both ADD and EDIT)
        addModelForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const modelId = document.getElementById('editModelId').value;
            const isEditing = !!modelId;

            // Gather all form data into an object
            const willingToWear = Array.from(document.querySelectorAll('#willingToWearCheckboxes input:checked')).map(cb => cb.value);
            const modelData = {
                id: isEditing ? modelId : `model-${Date.now()}`,
                fullName: document.getElementById('fullName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                email: document.getElementById('email').value,
                nationality: document.getElementById('nationality').value,
                languages: document.getElementById('languages').value,
                location: document.getElementById('location').value,
                height: document.getElementById('height').value,
                experience: document.getElementById('experience').value,
                clients: document.getElementById('clients').value,
                portfolio: document.getElementById('portfolio').value,
                willingToWear: willingToWear,
                rate: document.getElementById('rate').value,
                commission: document.getElementById('commission').value,
                iban: document.getElementById('iban').value,
                notes: document.getElementById('notes').value,
                profilePhotoUrl: '' // Will be set below
            };

            const profilePhotoInput = document.getElementById('profilePhoto');
            if (profilePhotoInput.files.length > 0) {
                // If a new photo is uploaded, read it as a Data URL
                modelData.profilePhotoUrl = await toBase64(profilePhotoInput.files[0]);
            } else if (isEditing) {
                // If editing and no new photo, keep the old one
                const existingCard = document.querySelector(`.model-card[data-model-id="${modelId}"]`);
                modelData.profilePhotoUrl = existingCard.querySelector('img').src;
            } else {
                 // If creating new and no photo, show error (handled by 'required' attribute)
                return;
            }

            if (isEditing) {
                // Update existing card
                const cardToUpdate = document.querySelector(`.model-card[data-model-id="${modelId}"]`);
                updateModelCard(cardToUpdate, modelData);
            } else {
                // Create a new card
                createModelCard(modelData);
            }

            showForm(false);
        });

        // Function to create a new model card element
        const createModelCard = (data) => {
            const card = document.createElement('div');
            card.className = 'bg-white rounded-xl shadow-md overflow-hidden model-card';
            card.dataset.modelId = data.id;
            updateModelCard(card, data); // Use update function to set innerHTML and data
            modelCardsContainer.appendChild(card);
        };

        // Function to update a card's content and data attribute
        const updateModelCard = (card, data) => {
            card.dataset.modelInfo = JSON.stringify(data);
            card.innerHTML = `
                <div class="relative">
                    <img class="h-64 w-full object-cover" src="${data.profilePhotoUrl}" alt="Model ${data.fullName}">
                    <div class="model-card-overlay">
                        <button class="edit-btn bg-blue-500 hover:bg-blue-600 p-3 rounded-full transition" title="Edit Model"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg></button>
                        <button class="delete-btn bg-red-500 hover:bg-red-600 p-3 rounded-full transition" title="Delete Model"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg></button>
                    </div>
                </div>
                <div class="p-4 cursor-pointer view-details-btn">
                    <h4 class="text-lg font-bold pointer-events-none">${data.fullName}</h4>
                    <p class="text-sm text-gray-500 pointer-events-none">${data.experience}</p>
                </div>
            `;
        };
        
        // Event Delegation for card actions (View, Edit, Delete)
        modelCardsContainer.addEventListener('click', (e) => {
            const card = e.target.closest('.model-card');
            if (!card) return;

            const modelData = JSON.parse(card.dataset.modelInfo);

            if (e.target.closest('.delete-btn')) {
                // Delete action
                if (confirm(`Are you sure you want to delete ${modelData.fullName}?`)) {
                    card.style.transform = 'scale(0)';
                    card.addEventListener('transitionend', () => card.remove());
                }
            } else if (e.target.closest('.edit-btn')) {
                // Edit action
                populateFormForEdit(modelData);
            } else if (e.target.closest('.view-details-btn')) {
                // View details action
                showModelDetailsModal(modelData);
            }
        });

        // Function to populate the form for editing a model
        const populateFormForEdit = (data) => {
            document.getElementById('editModelId').value = data.id;
            document.getElementById('form-title').textContent = `Editing: ${data.fullName}`;
            document.getElementById('save-model-btn').textContent = 'Update Model';
            
            // Populate all fields
            for (const key in data) {
                const el = document.getElementById(key);
                if (el) {
                    if (key === 'willingToWear') {
                        // Handle checkboxes
                        document.querySelectorAll('#willingToWearCheckboxes input').forEach(cb => {
                            cb.checked = data.willingToWear.includes(cb.value);
                        });
                    } else {
                        el.value = data[key];
                    }
                }
            }
            // Profile photo is not required for an update
            document.getElementById('profilePhoto').required = false;
            showForm(true);
            window.scrollTo(0, 0); // Scroll to top to see the form
        };

        // --- Model Search Functionality ---
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const allCards = document.querySelectorAll('.model-card');
            allCards.forEach(card => {
                const modelName = card.querySelector('h4').textContent.toLowerCase();
                card.classList.toggle('hidden', !modelName.includes(searchTerm));
            });
        });

        // --- Model Details Modal ---
        const showModelDetailsModal = (data) => {
            modalContentBox.innerHTML = `
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold mb-6">${data.fullName}</h2>
                    <button id="modal-close-btn" class="text-gray-500 hover:text-gray-800">&times;</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="md:col-span-1">
                        <img src="${data.profilePhotoUrl}" alt="${data.fullName}" class="rounded-lg shadow-lg w-full object-cover">
                    </div>
                    <div class="md:col-span-2 space-y-4">
                        <h3 class="text-xl font-semibold border-b pb-2">Details</h3>
                        <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm">
                            <p><strong>Nationality:</strong> ${data.nationality || 'N/A'}</p>
                            <p><strong>Location:</strong> ${data.location || 'N/A'}</p>
                            <p><strong>Height:</strong> ${data.height ? data.height + ' cm' : 'N/A'}</p>
                            <p><strong>Experience:</strong> ${data.experience || 'N/A'}</p>
                            <p><strong>Languages:</strong> ${data.languages || 'N/A'}</p>
                            <p><strong>Phone:</strong> ${data.phoneNumber || 'N/A'}</p>
                            <p class="col-span-2"><strong>Email:</strong> ${data.email || 'N/A'}</p>
                            <p class="col-span-2"><strong>Portfolio:</strong> <a href="${data.portfolio}" target="_blank" class="text-blue-600 hover:underline">${data.portfolio || 'N/A'}</a></p>
                            <p class="col-span-2"><strong>Wears:</strong> <span class="font-normal">${data.willingToWear.join(', ') || 'N/A'}</span></p>
                        </div>
                        <h3 class="text-xl font-semibold border-b pb-2 pt-4">Internal Info</h3>
                         <div class="grid grid-cols-2 gap-x-4 gap-y-2 text-sm">
                            <p><strong>Rate:</strong> ${data.rate ? '$' + data.rate + '/day' : 'N/A'}</p>
                            <p><strong>Commission:</strong> ${data.commission ? data.commission + '%' : 'N/A'}</p>
                            <p class="col-span-2"><strong>IBAN:</strong> ${data.iban || 'N/A'}</p>
                            <p class="col-span-2"><strong>Notes:</strong><br><span class="font-normal whitespace-pre-wrap">${data.notes || 'None'}</span></p>
                        </div>
                    </div>
                </div>
            `;
            modal.classList.add('show');
            // Add listener to the new close button
            document.getElementById('modal-close-btn').addEventListener('click', () => modal.classList.remove('show'));
        };

        // Close modal on overlay click
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.remove('show');
            }
        });
        
        // Helper to read file as Base64 for image previews
        const toBase64 = file => new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });

        // --- Lubna Chatbot (Existing Logic) ---
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatWindow = document.getElementById('chat-window');
        const typingIndicator = document.getElementById('typing-indicator');
        const apiKey = ""; // Leave empty
        let chatHistory = [];

        async function getBotResponse(prompt) {
            typingIndicator.classList.remove('hidden');
            chatWindow.scrollTop = chatWindow.scrollHeight;
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) throw new Error(`API request failed with status ${response.status}`);
                const result = await response.json();
                typingIndicator.classList.add('hidden');
                if (result.candidates && result.candidates[0]?.content?.parts?.[0]) {
                    const botText = result.candidates[0].content.parts[0].text;
                    chatHistory.push({ role: "model", parts: [{ text: botText }] });
                    appendMessage(botText, 'bot');
                } else {
                    appendMessage('Sorry, I could not process that. Please try again.', 'bot');
                }
            } catch (error) {
                console.error("Chatbot API Error:", error);
                typingIndicator.classList.add('hidden');
                appendMessage('Sorry, there was an error connecting to the assistant.', 'bot');
            }
        }

        function appendMessage(text, sender) {
            const messageWrapper = document.createElement('div');
            let messageHtml;
            if (sender === 'user') {
                messageWrapper.className = 'flex items-start gap-3 mb-4 justify-end';
                messageHtml = `<div class="chat-bubble-user p-3 rounded-lg max-w-lg"><p>${text}</p></div><div class="p-2 bg-yellow-400 text-gray-800 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-user"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></div>`;
            } else {
                messageWrapper.className = 'flex items-start gap-3 mb-4';
                messageHtml = `<div class="p-2 bg-gray-200 text-gray-800 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot"><path d="M12 8V4H8"/><rect width="16" height="12" x="4" y="8" rx="2"/><path d="M2 14h2"/><path d="M20 14h2"/><path d="M15 13v2"/><path d="M9 13v2"/></svg></div><div class="chat-bubble-bot p-3 rounded-lg max-w-lg"><p>${text}</p></div>`;
            }
            messageWrapper.innerHTML = messageHtml;
            chatWindow.appendChild(messageWrapper);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const userInput = chatInput.value.trim();
            if (userInput) {
                appendMessage(userInput, 'user');
                getBotResponse(userInput);
                chatInput.value = '';
            }
        });
    });
    </script>
</body>
</html>
